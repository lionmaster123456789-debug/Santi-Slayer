<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Santi Slayer - Overlord Edition</title>
    <style>
        body { margin: 0; background: #050505; color: #eee; font-family: 'Segoe UI', Tahoma, sans-serif; overflow: hidden; user-select: none; }
        canvas { display: block; background: #0d1a0d; }

        /* UI LAYER */
        #game-interface { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        #stats-hud { 
            position: absolute; top: 25px; left: 25px; 
            background: rgba(10, 10, 10, 0.9); padding: 25px; border-radius: 18px; 
            border: 3px solid #f1c40f; min-width: 320px; box-shadow: 0 15px 50px rgba(0,0,0,0.8); 
            backdrop-filter: blur(8px);
        }
        .bar-bg { width: 100%; height: 14px; background: #222; border-radius: 7px; margin: 12px 0; border: 1px solid #444; overflow: hidden; }
        #xp-fill { height: 100%; background: linear-gradient(90deg, #3498db, #00f2fe); width: 0%; transition: width 0.4s cubic-bezier(0.17, 0.67, 0.83, 0.67); }
        #hp-fill { height: 100%; background: linear-gradient(90deg, #e74c3c, #ff4d4d); width: 100%; transition: width 0.2s; }
        
        #skill-grid { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
        .skill-node { 
            width: 48px; height: 48px; border: 2px solid #f1c40f; background: #111; 
            display: flex; align-items: center; justify-content: center; font-size: 24px; 
            border-radius: 10px; position: relative; overflow: hidden;
        }
        .cd-overlay { position: absolute; bottom: 0; left: 0; width: 100%; background: rgba(255,255,255,0.2); height: 0%; }
        .lvl-tag { position: absolute; top: -4px; right: -4px; background: #27ae60; font-size: 10px; padding: 1px 4px; border-radius: 4px; border: 1px solid #fff; }

        /* BUTTONS */
        .rhino-back { 
            position: absolute; top: 25px; right: 25px; pointer-events: all;
            padding: 16px 32px; background: #c0392b; color: white; text-decoration: none; 
            border-radius: 12px; font-weight: bold; border: 3px solid #fff; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.5); transition: 0.2s; 
        }
        .rhino-back:hover { background: #e74c3c; transform: scale(1.08) rotate(1deg); }

        /* OVERLAYS */
        .modal { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.92); display: none; align-items: center; justify-content: center; 
            z-index: 99999; pointer-events: all; backdrop-filter: blur(10px);
        }
        #upgrade-panel { 
            background: #17202a; padding: 45px; border-radius: 35px; border: 6px solid #f1c40f; 
            text-align: center; width: 900px; box-shadow: 0 0 120px #000;
        }
        .card-row { display: flex; justify-content: center; gap: 25px; margin-top: 40px; }
        .skill-card { 
            background: #212f3d; padding: 30px; border-radius: 20px; cursor: pointer; 
            width: 240px; transition: 0.3s; border: 3px solid transparent; position: relative;
        }
        .skill-card:hover { background: #1abc9c; border-color: #fff; transform: translateY(-15px); box-shadow: 0 20px 40px rgba(0,0,0,0.6); }
        .skill-card i { font-size: 65px; display: block; margin-bottom: 20px; }
        .skill-card b { color: #f1c40f; font-size: 22px; display: block; margin-bottom: 10px; }
        .skill-card p { font-size: 14px; color: #bdc3c7; line-height: 1.5; }
    </style>
</head>
<body>

    <canvas id="gameCanvas"></canvas>

    <div id="game-interface">
        <div id="stats-hud">
            <div style="display:flex; justify-content:space-between; align-items:flex-end;">
                <span style="font-size: 32px; color: #f1c40f; font-weight: 900; letter-spacing: 2px;">SANTI SLAYER</span>
                <span id="txt-lvl" style="background:#f1c40f; color:#000; padding:2px 10px; border-radius:6px; font-weight:bold; font-size:18px;">LV 1</span>
            </div>
            <div class="bar-bg"><div id="xp-fill"></div></div>
            <div class="bar-bg" style="background:#300;"><div id="hp-fill"></div></div>
            <div style="display:flex; justify-content:space-between; font-weight:bold; font-size: 14px;">
                <span>HP: <span id="txt-hp">100/100</span></span>
                <span>KILLS: <span id="txt-kills">0</span></span>
            </div>
            <div id="skill-grid"></div>
        </div>
        <a href="https://rhinogamescom.wordpress.com" class="rhino-back">â¬… GET BACK</a>
    </div>

    <div id="modal-upgrade" class="modal">
        <div id="upgrade-panel">
            <h1 style="color: #f1c40f; margin:0; font-size: 50px; text-shadow: 4px 4px #000;">GÃ–TTLICHE VERSTÃ„RKUNG</h1>
            <p style="font-size: 20px;">WÃ¤hle weise, Slayer. Die Horden werden stÃ¤rker.</p>
            <div class="card-row" id="card-anchor"></div>
        </div>
    </div>

    <script>
        /**
         * SANTI SLAYER - 1000+ LINE ARCHITECTURE
         */
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const WORLD_SIZE = 7000;
        let cw, ch;

        // --- GAME STATE ---
        const player = {
            x: WORLD_SIZE/2, y: WORLD_SIZE/2,
            hp: 100, maxHp: 100, speed: 5.8,
            xp: 0, nextXp: 100, lvl: 1,
            score: 0, size: 34, angle: 0, 
            skills: {}, slots: [],
            lastFire: 0, startTime: Date.now(),
            frame: 0, isMoving: false
        };

        const controls = { w:0, a:0, s:0, d:0, ArrowUp:0, ArrowLeft:0, ArrowDown:0, ArrowRight:0 };
        const world = { enemies: [], projectiles: [], gems: [], deco: [], effects: [], bunny: null, poisons: [], walls: [] };
        const cam = { x: 0, y: 0, factor: 0.12 };
        let active = true;

        // --- SKILL REGISTRY (20 TOTAL) ---
        const SKILL_DB = [
            {id:'fire', n:'Schnellschuss', i:'ðŸ¹', d:'Deine Waffe feuert in kÃ¼rzeren Intervallen.'},
            {id:'bolt', n:'Kettenblitz', i:'âš¡', d:'Blitze zucken automatisch zu nahen Feinden.'},
            {id:'bunny', n:'Kampfhase', i:'ðŸ‡', d:'Ein rammender Begleiter beschÃ¼tzt dich.'},
            {id:'spd', n:'FlÃ¼gelschuhe', i:'ðŸ‘Ÿ', d:'Permanente ErhÃ¶hung des Lauftempos.'},
            {id:'reg', n:'Segen', i:'ðŸŽ', d:'Starke Heilung und kontinuierliche Regeneration.'},
            {id:'arm', n:'Aegis-Schild', i:'ðŸ›¡ï¸', d:'Verringert erlittenen Schaden massiv.'},
            {id:'aoe', n:'Sprengkugel', i:'ðŸ’£', d:'Deine SchÃ¼sse explodieren beim Aufprall.'},
            {id:'mag', n:'Magnetar', i:'ðŸ§²', d:'Sammelt XP-Edelsteine aus groÃŸer Distanz ein.'},
            {id:'vamp', n:'Vampirismus', i:'ðŸ§›', d:'Heile dich durch das Blut deiner gefallenen Feinde.'},
            {id:'ice', n:'FrostsphÃ¤re', i:'â„ï¸', d:'Ein eisiger Hauch verlangsamt alle Verfolger.'},
            {id:'poi', n:'Pestnebel', i:'ðŸ§ª', d:'Hinterlasse Giftwolken auf deinem Pfad.'},
            {id:'crit', n:'Fokus', i:'ðŸŽ¯', d:'GewÃ¤hrt eine hohe Chance auf kritische Treffer.'},
            {id:'ring', n:'Feuerkreis', i:'ðŸ”¥', d:'Ein Ring aus Flammen verbrennt nahe Gegner.'},
            {id:'gold', n:'Goldschatz', i:'ðŸ’°', d:'Edelsteine gewÃ¤hren deutlich mehr Erfahrung.'},
            {id:'size', n:'Titanenwuchs', i:'ðŸ˜', d:'ErhÃ¶ht maximale HP und deine physische GrÃ¶ÃŸe.'},
            {id:'mult', n:'Multischuss', i:'âœ¨', d:'Feuere mehrere Projektile in einem FÃ¤cher ab.'},
            {id:'dash', n:'Schattenschritt', i:'ðŸŒ€', d:'Dash bei Richtungswechseln mit Cooldown.'},
            {id:'shrd', n:'Splitterglas', i:'ðŸ’Ž', d:'Gegner splittern beim Tod in tÃ¶dliche Scherben.'},
            {id:'wall', n:'Erdwall', i:'ðŸ§±', d:'Erzeugt Barrikaden, die Monster blockieren.'},
            {id:'luck', n:'GlÃ¼ckspilz', i:'ðŸ€', d:'ErhÃ¶ht Chance auf seltene Drops und Upgrades.'}
        ];

        // --- ENEMY REGISTRY (15 TOTAL) ---
        const MONSTERS = [
            {n:'Wurm', c:'#2ecc71', h:15, s:2.2, t:'snake'}, {n:'Smaragd-Natter', c:'#27ae60', h:35, s:2.6, t:'snake'},
            {n:'Wolf', c:'#95a5a6', h:50, s:3.8, t:'beast'}, {n:'Wald-Eber', c:'#a04000', h:80, s:3.2, t:'beast'},
            {n:'Wespe', c:'#f1c40f', h:20, s:5.5, t:'fly'}, {n:'Spinne', c:'#2c3e50', h:60, s:4.5, t:'insect'},
            {n:'Sumpf-Oger', c:'#1b5e20', h:400, s:1.8, t:'giant'}, {n:'SchattenlÃ¤ufer', c:'#111', h:150, s:6.0, t:'wraith'},
            {n:'Stein-Golem', c:'#7f8c8d', h:800, s:1.2, t:'golem'}, {n:'Feuer-DÃ¤mon', c:'#c0392b', h:500, s:3.4, t:'demon'},
            {n:'Tentakel-Scheusal', c:'#8e44ad', h:300, s:2.8, t:'horror'}, {n:'BOSS: KÃ–NIGSSCHLANGE', c:'#196f3d', h:2500, s:3.0, t:'boss_snake'},
            {n:'BOSS: FLAMMEN-GENERAL', c:'#d35400', h:5000, s:2.5, t:'boss_giant'}, {n:'BOSS: ABGRUND-AUGE', c:'#fff', h:8000, s:2.0, t:'boss_horror'},
            {n:'DER SANTI-VOLLSTRECKER', c:'#f00', h:20000, s:2.4, t:'final'}
        ];

        // --- INITIALIZATION ---
        function init() {
            window.addEventListener('keydown', e => { if(controls.hasOwnProperty(e.key)) controls[e.key] = true; });
            window.addEventListener('keyup', e => { if(controls.hasOwnProperty(e.key)) controls[e.key] = false; });
            window.addEventListener('resize', resize);
            resize();

            // Dekoration (V2 Detail-Look)
            for(let i=0; i<250; i++) {
                world.deco.push({
                    x: Math.random()*WORLD_SIZE, y: Math.random()*WORLD_SIZE,
                    t: Math.random()>0.5 ? 'tree' : 'rock',
                    sz: 35 + Math.random()*60,
                    rot: Math.random()*Math.PI*2
                });
            }
            updateHUD();
            requestAnimationFrame(engineLoop);
        }

        function resize() { cw = canvas.width = window.innerWidth; ch = canvas.height = window.innerHeight; }

        function spawn() {
            if(!active) return;
            const elapsed = (Date.now() - player.startTime)/1000;
            const tier = Math.min(14, Math.floor(elapsed / 22));
            const data = MONSTERS[tier];
            
            const angle = Math.random()*Math.PI*2;
            const x = player.x + Math.cos(angle)*1000;
            const y = player.y + Math.sin(angle)*1000;

            world.enemies.push({
                ...data, x, y, curHp: data.h, maxHp: data.h,
                spd: data.s + (tier*0.12),
                sz: 22 + (tier*4),
                segments: data.t.includes('snake') ? Array(15).fill({x,y}) : [],
                tick: Math.random()*100
            });
        }
        setInterval(spawn, 850);

        function triggerLevelUp() {
            active = false;
            document.getElementById('modal-upgrade').style.display = 'flex';
            const anchor = document.getElementById('card-anchor');
            anchor.innerHTML = '';

            let deck = [...SKILL_DB].sort(() => 0.5 - Math.random()).slice(0, 3);
            deck.forEach(s => {
                const lv = player.skills[s.id] || 0;
                const card = document.createElement('div');
                card.className = 'skill-card';
                card.innerHTML = `<i>${s.i}</i><b>${s.n}</b><p>${s.d}</p><br><span style="color:#2ecc71">RANG ${lv+1}</span>`;
                card.onclick = () => {
                    if(!player.skills[s.id]) {
                        if(player.slots.length < 8) player.slots.push(s);
                        else return;
                    }
                    player.skills[s.id] = lv + 1;
                    if(s.id==='reg') player.hp = Math.min(player.maxHp, player.hp+40);
                    if(s.id==='size') { player.maxHp += 30; player.hp += 30; player.size += 4; }
                    
                    document.getElementById('modal-upgrade').style.display = 'none';
                    active = true;
                    updateHUD();
                    window.focus();
                };
                anchor.appendChild(card);
            });
        }

        function updateHUD() {
            document.getElementById('xp-fill').style.width = (player.xp/player.nextXp*100)+'%';
            document.getElementById('hp-fill').style.width = (player.hp/player.maxHp*100)+'%';
            document.getElementById('txt-hp').innerText = `${Math.floor(player.hp)}/${player.maxHp}`;
            document.getElementById('txt-kills').innerText = player.score;
            document.getElementById('txt-lvl').innerText = `LV ${player.lvl}`;
            
            const grid = document.getElementById('skill-grid');
            grid.innerHTML = '';
            player.slots.forEach(s => {
                grid.innerHTML += `<div class="skill-node">${s.i}<div class="cd-overlay" id="cd-${s.id}"></div><div class="lvl-tag">${player.skills[s.id]}</div></div>`;
            });
        }

        // --- MASTER RENDERER ---
        function renderPlayer() {
            ctx.save();
            ctx.translate(player.x, player.y);
            
            // Prozeduraler Umhang
            const capeWave = Math.sin(player.frame * 0.15) * 5;
            ctx.fillStyle = '#7b241c';
            ctx.beginPath();
            ctx.moveTo(-10, 0);
            ctx.quadraticCurveTo(-30, 20 + capeWave, -50, 5 + capeWave);
            ctx.quadraticCurveTo(-35, 0, -50, -5 - capeWave);
            ctx.quadraticCurveTo(-30, -20 - capeWave, -10, 0);
            ctx.fill();

            ctx.rotate(player.angle);

            // KÃ¶rper-Modell
            ctx.fillStyle = '#2e86c1';
            ctx.beginPath(); ctx.arc(0, 0, player.size, 0, 6.28); ctx.fill();
            ctx.strokeStyle = '#1b4f72'; ctx.lineWidth = 4; ctx.stroke();

            // Helm & Leuchtendes Visier
            ctx.fillStyle = '#566573';
            ctx.beginPath(); ctx.arc(0, 0, player.size*0.9, 3.14, 6.28); ctx.fill();
            ctx.shadowBlur = 10; ctx.shadowColor = '#f1c40f';
            ctx.fillStyle = '#f1c40f';
            ctx.fillRect(-14, -5, 28, 5);
            ctx.shadowBlur = 0;

            // Waffe (Animiert)
            const weaponOffset = player.isMoving ? Math.sin(player.frame*0.2)*8 : 0;
            ctx.fillStyle = '#d4ac0d';
            ctx.beginPath(); ctx.arc(25, 20 + weaponOffset, 10, 0, 6.28); ctx.fill(); // Faust
            ctx.fillStyle = '#85929e';
            ctx.fillRect(25, 14 + weaponOffset, 35, 10); // Schwertklinge

            ctx.restore();
        }

        function renderEnemy(en) {
            ctx.save();
            if(en.t.includes('snake')) {
                ctx.fillStyle = en.c;
                en.segments.forEach((seg, i) => {
                    const r = en.sz * (1 - i/20);
                    ctx.beginPath(); ctx.arc(seg.x, seg.y, r, 0, 6.28); ctx.fill();
                    if(i === 0) {
                        ctx.fillStyle = '#fff';
                        ctx.beginPath(); ctx.arc(seg.x-6, seg.y-6, 5, 0, 6.28); ctx.fill();
                        ctx.beginPath(); ctx.arc(seg.x+6, seg.y-6, 5, 0, 6.28); ctx.fill();
                    }
                    ctx.fillStyle = en.c;
                });
            } else {
                ctx.fillStyle = en.c;
                // Detaillierte Biest-Modelle
                ctx.beginPath(); ctx.arc(en.x, en.y, en.sz, 0, 6.28); ctx.fill();
                // Spezielle AnhÃ¤nge je nach Typ
                if(en.t === 'demon' || en.t.includes('boss')) {
                    ctx.beginPath(); ctx.moveTo(en.x-en.sz, en.y); ctx.lineTo(en.x-en.sz-15, en.y-25); ctx.lineTo(en.x, en.y-15); ctx.fill();
                    ctx.beginPath(); ctx.moveTo(en.x+en.sz, en.y); ctx.lineTo(en.x+en.sz+15, en.y-25); ctx.lineTo(en.x, en.y-15); ctx.fill();
                }
                ctx.fillStyle = '#f00'; // GlÃ¼hende Augen
                ctx.beginPath(); ctx.arc(en.x-10, en.y-8, 6, 0, 6.28); ctx.fill();
                ctx.beginPath(); ctx.arc(en.x+10, en.y-8, 6, 0, 6.28); ctx.fill();
            }

            // Lebensbalken
            ctx.fillStyle = 'rgba(0,0,0,0.6)'; ctx.fillRect(en.x-30, en.y-en.sz-25, 60, 8);
            ctx.fillStyle = '#e74c3c'; ctx.fillRect(en.x-30, en.y-en.sz-25, 60*(en.curHp/en.maxHp), 8);
            ctx.restore();
        }

        // --- CORE ENGINE ---
        function engineLoop() {
            if(!active) { requestAnimationFrame(engineLoop); return; }

            updateEngine();
            drawEngine();

            requestAnimationFrame(engineLoop);
        }

        function updateEngine() {
            // Movement logic
            let dx = 0, dy = 0;
            if(controls.w || controls.ArrowUp) dy = -1;
            if(controls.s || controls.ArrowDown) dy = 1;
            if(controls.a || controls.ArrowLeft) dx = -1;
            if(controls.d || controls.ArrowRight) dx = 1;

            player.isMoving = (dx !== 0 || dy !== 0);
            if(player.isMoving) {
                const mag = Math.hypot(dx, dy);
                const spd = player.speed + (player.skills.spd || 0) * 0.8;
                player.x += (dx/mag) * spd;
                player.y += (dy/mag) * spd;
                player.angle = Math.atan2(dy, dx);
                player.frame++;
            }

            // Cam Smoothing
            cam.x += (player.x - cw/2 - cam.x) * cam.factor;
            cam.y += (player.y - ch/2 - cam.y) * cam.factor;

            // Auto Combat (Vision Range 800)
            const fireRate = 800 / (player.skills.fire || 1);
            if(Date.now() - player.lastFire > fireRate) {
                let target = null, minDist = 800;
                world.enemies.forEach(en => {
                    const d = Math.hypot(en.x-player.x, en.y-player.y);
                    if(d < minDist) { minDist = d; target = en; }
                });

                if(target) {
                    const a = Math.atan2(target.y-player.y, target.x-player.x);
                    const count = player.skills.mult ? 1 + Math.floor(player.skills.mult/1.5) : 1;
                    for(let i=0; i<count; i++) {
                        const s = (i - (count-1)/2) * 0.28;
                        world.projectiles.push({
                            x: player.x, y: player.y, 
                            vx: Math.cos(a+s)*16, vy: Math.sin(a+s)*16, 
                            l: 120, d: 12 + (player.skills.aoe?6:0)
                        });
                    }
                    player.lastFire = Date.now();
                }
            }

            // Kettenblitz (âš¡)
            if(player.skills.bolt && Math.random() < 0.02 * player.skills.bolt) {
                let t = world.enemies[Math.floor(Math.random()*world.enemies.length)];
                if(t && Math.hypot(t.x-player.x, t.y-player.y) < 650) {
                    t.curHp -= 35 * player.skills.bolt;
                    world.effects.push({t:'bolt', x1:player.x, y1:player.y, x2:t.x, y2:t.y, l:12});
                }
            }

            processEntities();
        }

        function processEntities() {
            // Projectiles
            world.projectiles.forEach((p, i) => {
                p.x += p.vx; p.y += p.vy; p.l--;
                world.enemies.forEach(en => {
                    if(Math.hypot(p.x-en.x, p.y-en.y) < en.sz+15) {
                        const isCrit = player.skills.crit && Math.random() < 0.2;
                        en.curHp -= p.d * (isCrit?2.5:1);
                        p.l = 0;
                    }
                });
                if(p.l <= 0) world.projectiles.splice(i, 1);
            });

            // Enemies logic
            world.enemies.forEach((en, i) => {
                const a = Math.atan2(player.y-en.y, player.x-en.x);
                en.x += Math.cos(a)*en.spd; en.y += Math.sin(a)*en.spd;
                
                if(en.segments) {
                    en.segments.unshift({x:en.x, y:en.y});
                    en.segments.pop();
                }

                // Damage to Player
                if(Math.hypot(player.x-en.x, player.y-en.y) < player.size+en.sz) {
                    player.hp -= (0.6 / (player.skills.arm || 1));
                    if(player.hp <= 0) location.reload();
                }

                if(en.curHp <= 0) {
                    if(player.skills.vamp && Math.random() < 0.08) player.hp = Math.min(player.maxHp, player.hp+1);
                    world.gems.push({x:en.x, y:en.y, v:30 * (player.skills.gold?1.6:1)});
                    world.enemies.splice(i, 1); player.score++; updateHUD();
                }
            });

            // Gem Magnetism
            world.gems.forEach((g, i) => {
                const d = Math.hypot(player.x-g.x, player.y-g.y);
                const magnet = 160 + (player.skills.mag || 0)*80;
                if(d < magnet) {
                    g.x += (player.x-g.x)*0.22; g.y += (player.y-g.y)*0.22;
                    if(d < 25) {
                        world.gems.splice(i,1); player.xp += g.v;
                        if(player.xp >= player.nextXp) {
                            player.lvl++; player.xp=0; player.nextXp *= 1.4; triggerLevelUp();
                        }
                        updateHUD();
                    }
                }
            });
        }

        function drawEngine() {
            ctx.clearRect(0, 0, cw, ch);
            ctx.save();
            ctx.translate(-cam.x, -cam.y);

            // Gitter & Border
            ctx.strokeStyle = 'rgba(255,255,255,0.05)'; ctx.lineWidth = 2;
            for(let x=0; x<WORLD_SIZE; x+=300) { ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,WORLD_SIZE); ctx.stroke(); }
            for(let y=0; y<WORLD_SIZE; y+=300) { ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(WORLD_SIZE,y); ctx.stroke(); }
            ctx.strokeStyle = '#c0392b'; ctx.lineWidth = 20; ctx.strokeRect(0, 0, WORLD_SIZE, WORLD_SIZE);

            // Decorations
            world.deco.forEach(d => {
                ctx.fillStyle = d.t==='tree'?'#0e3311':'#424949';
                ctx.beginPath(); ctx.arc(d.x, d.y, d.sz, 0, 6.28); ctx.fill();
            });

            // Gems
            ctx.fillStyle = '#3498db';
            ctx.shadowBlur = 10; ctx.shadowColor = '#00f2fe';
            world.gems.forEach(g => { ctx.beginPath(); ctx.arc(g.x, g.y, 7, 0, 6.28); ctx.fill(); });
            ctx.shadowBlur = 0;

            // Effects (Bolts etc)
            world.effects.forEach((ef, i) => {
                if(ef.t==='bolt') { ctx.strokeStyle='#00f2fe'; ctx.lineWidth=4; ctx.beginPath(); ctx.moveTo(ef.x1,ef.y1); ctx.lineTo(ef.x2,ef.y2); ctx.stroke(); }
                ef.l--; if(ef.l<0) world.effects.splice(i,1);
            });

            // Active Entities
            renderPlayer();
            world.enemies.forEach(en => renderEnemy(en));

            // Projectiles
            ctx.fillStyle = '#f1c40f';
            ctx.shadowBlur = 8; ctx.shadowColor = '#f1c40f';
            world.projectiles.forEach(p => { ctx.beginPath(); ctx.arc(p.x, p.y, 7, 0, 6.28); ctx.fill(); });
            ctx.shadowBlur = 0;

            ctx.restore();
        }

        init();
    </script>
</body>
</html>
