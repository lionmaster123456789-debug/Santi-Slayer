<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Santi Slayer - Overlord Edition</title>
    <style>
        body { margin: 0; background: #050505; color: #eee; font-family: 'Segoe UI', Tahoma, sans-serif; overflow: hidden; user-select: none; }
        canvas { display: block; background: #0d1a0d; }

        /* UI LAYER */
        #game-interface { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        #stats-hud { 
            position: absolute; top: 25px; left: 25px; 
            background: rgba(10, 10, 10, 0.9); padding: 25px; border-radius: 18px; 
            border: 3px solid #f1c40f; min-width: 320px; box-shadow: 0 15px 50px rgba(0,0,0,0.8); 
            backdrop-filter: blur(8px);
        }
        .bar-bg { width: 100%; height: 14px; background: #222; border-radius: 7px; margin: 12px 0; border: 1px solid #444; overflow: hidden; }
        #xp-fill { height: 100%; background: linear-gradient(90deg, #3498db, #00f2fe); width: 0%; transition: width 0.4s; }
        #hp-fill { height: 100%; background: linear-gradient(90deg, #e74c3c, #ff4d4d); width: 100%; transition: width 0.2s; }
        
        #skill-grid { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
        .skill-node { 
            width: 48px; height: 48px; border: 2px solid #f1c40f; background: #111; 
            display: flex; align-items: center; justify-content: center; font-size: 24px; 
            border-radius: 10px; position: relative; overflow: hidden;
        }
        .cd-overlay { position: absolute; bottom: 0; left: 0; width: 100%; background: rgba(255,255,255,0.2); height: 0%; }
        .lvl-tag { position: absolute; top: -4px; right: -4px; background: #27ae60; font-size: 10px; padding: 1px 4px; border-radius: 4px; border: 1px solid #fff; }

        .rhino-back { 
            position: absolute; top: 25px; right: 25px; pointer-events: all;
            padding: 16px 32px; background: #c0392b; color: white; text-decoration: none; 
            border-radius: 12px; font-weight: bold; border: 3px solid #fff; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.5); transition: 0.2s; 
        }
        .rhino-back:hover { background: #e74c3c; transform: scale(1.08); }

        .modal { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.92); display: none; align-items: center; justify-content: center; 
            z-index: 99999; pointer-events: all; backdrop-filter: blur(10px);
        }
        #upgrade-panel { 
            background: #17202a; padding: 45px; border-radius: 35px; border: 6px solid #f1c40f; 
            text-align: center; width: 900px; box-shadow: 0 0 120px #000;
        }
        .card-row { display: flex; justify-content: center; gap: 25px; margin-top: 40px; }
        .skill-card { 
            background: #212f3d; padding: 30px; border-radius: 20px; cursor: pointer; 
            width: 240px; transition: 0.3s; border: 3px solid transparent;
        }
        .skill-card:hover { background: #1abc9c; border-color: #fff; transform: translateY(-15px); }
        .skill-card i { font-size: 65px; display: block; margin-bottom: 20px; }
        .skill-card b { color: #f1c40f; font-size: 22px; display: block; }
        .skill-card p { font-size: 14px; color: #bdc3c7; line-height: 1.5; margin: 15px 0; }
    </style>
</head>
<body>

    <canvas id="gameCanvas"></canvas>

    <div id="game-interface">
        <div id="stats-hud">
            <div style="display:flex; justify-content:space-between; align-items:flex-end;">
                <span style="font-size: 32px; color: #f1c40f; font-weight: 900;">SANTI SLAYER</span>
                <span id="txt-lvl" style="background:#f1c40f; color:#000; padding:2px 10px; border-radius:6px; font-weight:bold;">LV 1</span>
            </div>
            <div class="bar-bg"><div id="xp-fill"></div></div>
            <div class="bar-bg" style="background:#300;"><div id="hp-fill"></div></div>
            <div style="display:flex; justify-content:space-between; font-weight:bold; font-size: 14px;">
                <span>HP: <span id="txt-hp">100/100</span></span>
                <span>KILLS: <span id="txt-kills">0</span></span>
            </div>
            <div id="skill-grid"></div>
        </div>
        <a href="https://rhinogamescom.wordpress.com" class="rhino-back">â¬… GET BACK</a>
    </div>

    <div id="modal-upgrade" class="modal">
        <div id="upgrade-panel">
            <h1 style="color: #f1c40f; margin:0; font-size: 50px;">GÃ–TTLICHER AUFSTIEG</h1>
            <div class="card-row" id="card-anchor"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const WORLD_SIZE = 6000;
        let cw, ch;

        // --- GAME STATE ---
        const player = {
            x: WORLD_SIZE/2, y: WORLD_SIZE/2,
            hp: 100, maxHp: 100, speed: 5.8,
            xp: 0, nextXp: 100, lvl: 1,
            score: 0, size: 34, angle: 0, 
            skills: {}, slots: [],
            lastFire: 0, startTime: Date.now(),
            frame: 0, isMoving: false,
            dashCd: 0, poisonTick: 0
        };

        const controls = { w:0, a:0, s:0, d:0, ArrowUp:0, ArrowLeft:0, ArrowDown:0, ArrowRight:0 };
        const world = { enemies: [], projectiles: [], gems: [], deco: [], effects: [], bunny: null, poisons: [], walls: [] };
        const cam = { x: 0, y: 0, factor: 0.12 };
        let active = true;

        // --- SKILL REGISTRY (Alle 20 mit Logik-Hooks) ---
        const SKILL_DB = [
            {id:'fire', n:'Schnellschuss', i:'ðŸ¹', d:'Feuert in kÃ¼rzeren Intervallen auf automatische Ziele.'},
            {id:'bolt', n:'Kettenblitz', i:'âš¡', d:'Blitze zucken zu nahen Feinden und verursachen Schock.'},
            {id:'bunny', n:'Kampfhase', i:'ðŸ‡', d:'Ein rammender Begleiter, der Feinde im Umkreis zermalmt.'},
            {id:'spd', n:'FlÃ¼gelschuhe', i:'ðŸ‘Ÿ', d:'Permanente ErhÃ¶hung deines Lauftempos.'},
            {id:'reg', n:'Segen', i:'ðŸŽ', d:'Starke Heilung und kontinuierliche Regeneration.'},
            {id:'arm', n:'Aegis-Schild', i:'ðŸ›¡ï¸', d:'Verringert erlittenen Schaden massiv durch gÃ¶ttliches Licht.'},
            {id:'aoe', n:'Sprengkugel', i:'ðŸ’£', d:'Deine SchÃ¼sse explodieren beim Aufprall in einer Druckwelle.'},
            {id:'mag', n:'Magnetar', i:'ðŸ§²', d:'Sammelt XP-Edelsteine aus extrem groÃŸer Distanz ein.'},
            {id:'vamp', n:'Vampirismus', i:'ðŸ§›', d:'Heile dich durch das vergossene Blut deiner gefallenen Feinde.'},
            {id:'ice', n:'FrostsphÃ¤re', i:'â„ï¸', d:'Ein eisiger Hauch verlangsamt alle Verfolger im Umkreis.'},
            {id:'poi', n:'Pestnebel', i:'ðŸ§ª', d:'Hinterlasse tÃ¶dliche Giftwolken auf deinem Pfad.'},
            {id:'crit', n:'Fokus', i:'ðŸŽ¯', d:'GewÃ¤hrt eine hohe Chance auf verheerende kritische Treffer.'},
            {id:'ring', n:'Feuerkreis', i:'ðŸ”¥', d:'Ein Ring aus Flammen verbrennt permanent nahe Gegner.'},
            {id:'gold', n:'Goldschatz', i:'ðŸ’°', d:'Edelsteine gewÃ¤hren deutlich mehr Erfahrungspunkte.'},
            {id:'size', n:'Titanenwuchs', i:'ðŸ˜', d:'ErhÃ¶ht deine VitalitÃ¤t und deine physische PrÃ¤senz.'},
            {id:'mult', n:'Multischuss', i:'âœ¨', d:'Feuere zusÃ¤tzliche Projektile in einem FÃ¤cher ab.'},
            {id:'dash', n:'Schattenschritt', i:'ðŸŒ€', d:'Schneller Ausweich-Dash bei Richtungswechseln.'},
            {id:'shrd', n:'Splitterglas', i:'ðŸ’Ž', d:'Gegner splittern beim Tod in tÃ¶dliche Scherben.'},
            {id:'wall', n:'Erdwall', i:'ðŸ§±', d:'Erzeugt Barrikaden, die Monster physisch blockieren.'},
            {id:'luck', n:'GlÃ¼ckspilz', i:'ðŸ€', d:'Bessere Upgrade-Auswahl und mehr kritische ZufÃ¤lle.'}
        ];

        // --- ENEMY MODELS (15 Echte Modelle) ---
        const MONSTERS = [
            {n:'Waldwurm', c:'#2ecc71', h:20, s:2.2, t:'snake'},
            {n:'Steppenwolf', c:'#95a5a6', h:50, s:3.8, t:'wolf'},
            {n:'Riesenwespe', c:'#f1c40f', h:30, s:5.5, t:'wasp'},
            {n:'HÃ¶hlenbÃ¤r', c:'#5d4037', h:200, s:1.8, t:'bear'},
            {n:'Skorpion', c:'#d35400', h:120, s:3.0, t:'insect'},
            {n:'Sumpf-Oger', c:'#1b5e20', h:500, s:1.5, t:'ogre'},
            {n:'SchattenlÃ¤ufer', c:'#111', h:180, s:6.2, t:'wraith'},
            {n:'Stein-Golem', c:'#7f8c8d', h:1000, s:1.0, t:'golem'},
            {n:'HÃ¶llendÃ¤mon', c:'#c0392b', h:800, s:3.5, t:'demon'},
            {n:'Frostspinne', c:'#d6eaf8', h:450, s:4.0, t:'spider'},
            {n:'Tentakel-Scheusal', c:'#8e44ad', h:600, s:2.5, t:'horror'},
            {n:'Hydra', c:'#196f3d', h:1500, s:2.8, t:'hydra'},
            {n:'Blut-Eber', c:'#641e16', h:900, s:4.5, t:'boar'},
            {n:'Drachen-WÃ¤chter', c:'#c0392b', h:3000, s:3.0, t:'dragon'},
            {n:'SANTI-SCHLÃ„CHTER', c:'#fff', h:15000, s:2.2, t:'ultimate'}
        ];

        function init() {
            window.addEventListener('keydown', e => { if(controls.hasOwnProperty(e.key)) controls[e.key] = true; });
            window.addEventListener('keyup', e => { if(controls.hasOwnProperty(e.key)) controls[e.key] = false; });
            window.addEventListener('resize', resize);
            resize();

            for(let i=0; i<300; i++) {
                world.deco.push({
                    x: Math.random()*WORLD_SIZE, y: Math.random()*WORLD_SIZE,
                    t: Math.random()>0.5 ? 'tree' : 'rock',
                    sz: 40 + Math.random()*70,
                    rot: Math.random()*Math.PI*2
                });
            }
            updateHUD();
            requestAnimationFrame(engineLoop);
        }

        function resize() { cw = canvas.width = window.innerWidth; ch = canvas.height = window.innerHeight; }

        function spawn() {
            if(!active) return;
            const elapsed = (Date.now() - player.startTime)/1000;
            const tier = Math.min(14, Math.floor(elapsed / 25));
            const data = MONSTERS[tier];
            
            const angle = Math.random()*Math.PI*2;
            const x = player.x + Math.cos(angle)*1100;
            const y = player.y + Math.sin(angle)*1100;

            world.enemies.push({
                ...data, x, y, curHp: data.h, maxHp: data.h,
                spd: data.s + (tier*0.15),
                sz: 25 + (tier*5),
                segments: data.t.includes('snake') || data.t==='hydra' ? Array(12).fill({x,y}) : [],
                tick: 0
            });
        }
        setInterval(spawn, 900);

        function triggerLevelUp() {
            active = false;
            document.getElementById('modal-upgrade').style.display = 'flex';
            const anchor = document.getElementById('card-anchor');
            anchor.innerHTML = '';

            let deck = [...SKILL_DB].sort(() => 0.5 - Math.random()).slice(0, 3);
            deck.forEach(s => {
                const lv = player.skills[s.id] || 0;
                const card = document.createElement('div');
                card.className = 'skill-card';
                card.innerHTML = `<i>${s.i}</i><b>${s.n}</b><p>${s.d}</p><br><b style="color:#2ecc71">Rang ${lv+1}</b>`;
                card.onclick = () => {
                    if(!player.skills[s.id]) {
                        if(player.slots.length < 8) player.slots.push(s);
                        else return;
                    }
                    player.skills[s.id] = lv + 1;
                    if(s.id==='reg') player.hp = Math.min(player.maxHp, player.hp+50);
                    if(s.id==='size') { player.maxHp += 30; player.hp += 30; player.size += 4; }
                    
                    document.getElementById('modal-upgrade').style.display = 'none';
                    active = true;
                    updateHUD();
                    window.focus();
                };
                anchor.appendChild(card);
            });
        }

        function updateHUD() {
            document.getElementById('xp-fill').style.width = (player.xp/player.nextXp*100)+'%';
            document.getElementById('hp-fill').style.width = (player.hp/player.maxHp*100)+'%';
            document.getElementById('txt-hp').innerText = `${Math.floor(player.hp)}/${player.maxHp}`;
            document.getElementById('txt-kills').innerText = player.score;
            document.getElementById('txt-lvl').innerText = `LV ${player.lvl}`;
            
            const grid = document.getElementById('skill-grid');
            grid.innerHTML = '';
            player.slots.forEach(s => {
                grid.innerHTML += `<div class="skill-node">${s.i}<div class="lvl-tag">${player.skills[s.id]}</div></div>`;
            });
        }

        // --- COMPLEX RENDERERS ---
        function renderPlayer() {
            ctx.save();
            ctx.translate(player.x, player.y);
            
            // Animierter Umhang (V2+)
            const capeWave = Math.sin(player.frame * 0.2) * 6;
            ctx.fillStyle = '#7b241c';
            ctx.beginPath();
            ctx.moveTo(-12, 0);
            ctx.quadraticCurveTo(-35, 25 + capeWave, -55, 5 + capeWave);
            ctx.quadraticCurveTo(-40, 0, -55, -5 - capeWave);
            ctx.quadraticCurveTo(-35, -25 - capeWave, -12, 0);
            ctx.fill();

            ctx.rotate(player.angle);

            // Charakter-Body
            ctx.fillStyle = '#2471a3';
            ctx.beginPath(); ctx.arc(0, 0, player.size, 0, 6.28); ctx.fill();
            ctx.strokeStyle = '#1b4f72'; ctx.lineWidth = 4; ctx.stroke();

            // Helm & Leucht-Visier
            ctx.fillStyle = '#5d6d7e';
            ctx.beginPath(); ctx.arc(0, 0, player.size*0.9, 3.14, 6.28); ctx.fill();
            ctx.fillStyle = '#f1c40f'; // GlÃ¼hendes Gelb
            ctx.shadowBlur = 15; ctx.shadowColor = '#f1c40f';
            ctx.fillRect(-16, -6, 32, 6);
            ctx.shadowBlur = 0;

            // Waffe (Dynamisch)
            const weaponY = Math.sin(player.frame*0.25)*8;
            ctx.fillStyle = '#d4ac0d';
            ctx.beginPath(); ctx.arc(28, 20+weaponY, 10, 0, 6.28); ctx.fill(); // Faust
            ctx.fillStyle = '#85929e';
            ctx.fillRect(28, 14+weaponY, 40, 12); // Klinge

            ctx.restore();
        }

        function renderEnemy(en) {
            ctx.save();
            ctx.fillStyle = en.c;
            
            if(en.t==='snake' || en.t==='hydra') {
                en.segments.forEach((seg, i) => {
                    const r = en.sz * (1 - i/18);
                    ctx.beginPath(); ctx.arc(seg.x, seg.y, r, 0, 6.28); ctx.fill();
                });
            } else if(en.t==='wolf' || en.t==='boar') {
                ctx.beginPath(); ctx.ellipse(en.x, en.y, en.sz*1.2, en.sz, Math.atan2(player.y-en.y, player.x-en.x), 0, 6.28); ctx.fill();
                ctx.beginPath(); ctx.arc(en.x, en.y-en.sz*0.8, en.sz*0.4, 0, 6.28); ctx.fill(); // Kopf
            } else if(en.t==='bear' || en.t==='ogre' || en.t==='golem') {
                ctx.beginPath(); ctx.roundRect(en.x-en.sz, en.y-en.sz, en.sz*2, en.sz*2, 10); ctx.fill();
                ctx.fillStyle = '#000'; ctx.beginPath(); ctx.arc(en.x-en.sz/2, en.y-en.sz/3, 5, 0, 6.28); ctx.fill();
            } else if(en.t==='demon' || en.t==='wraith') {
                ctx.beginPath(); ctx.arc(en.x, en.y, en.sz, 0, 6.28); ctx.fill();
                ctx.beginPath(); ctx.moveTo(en.x-en.sz, en.y); ctx.lineTo(en.x-en.sz-20, en.y-30); ctx.lineTo(en.x, en.y-10); ctx.fill(); // FlÃ¼gel/HÃ¶rner
                ctx.beginPath(); ctx.moveTo(en.x+en.sz, en.y); ctx.lineTo(en.x+en.sz+20, en.y-30); ctx.lineTo(en.x, en.y-10); ctx.fill();
            } else {
                ctx.beginPath(); ctx.arc(en.x, en.y, en.sz, 0, 6.28); ctx.fill();
            }

            // Status: Augen
            ctx.fillStyle = '#f00';
            ctx.beginPath(); ctx.arc(en.x-10, en.y-en.sz/3, 5, 0, 6.28); ctx.fill();
            ctx.beginPath(); ctx.arc(en.x+10, en.y-en.sz/3, 5, 0, 6.28); ctx.fill();

            // HP-Balken
            ctx.fillStyle = 'rgba(0,0,0,0.6)'; ctx.fillRect(en.x-35, en.y-en.sz-30, 70, 10);
            ctx.fillStyle = '#e74c3c'; ctx.fillRect(en.x-35, en.y-en.sz-30, 70*(en.curHp/en.maxHp), 10);
            ctx.restore();
        }

        // --- ENGINE ---
        function engineLoop() {
            if(!active) { requestAnimationFrame(engineLoop); return; }

            // 1. INPUT & MOVEMENT
            let dx=0, dy=0;
            if(controls.w || controls.ArrowUp) dy = -1;
            if(controls.s || controls.ArrowDown) dy = 1;
            if(controls.a || controls.ArrowLeft) dx = -1;
            if(controls.d || controls.ArrowRight) dx = 1;

            player.isMoving = (dx!==0 || dy!==0);
            if(player.isMoving) {
                const mag = Math.hypot(dx, dy);
                const spd = player.speed + (player.skills.spd || 0) * 0.9;
                
                // Skill: Dash (ðŸŒ€)
                if(player.skills.dash && player.dashCd <= 0 && mag > 0) {
                   if(Math.random() < 0.05) { // Kleiner Prozeduraler Dash-Effekt
                       player.x += (dx/mag) * 120;
                       player.y += (dy/mag) * 120;
                       player.dashCd = 120;
                       world.effects.push({t:'dash', x:player.x, y:player.y, l:15});
                   }
                }
                
                player.x += (dx/mag) * spd;
                player.y += (dy/mag) * spd;
                player.angle = Math.atan2(dy, dx);
                player.frame++;
            }
            if(player.dashCd > 0) player.dashCd--;

            // 2. CAMERA
            cam.x += (player.x - cw/2 - cam.x) * cam.factor;
            cam.y += (player.y - ch/2 - cam.y) * cam.factor;

            // 3. SKILLS LOGIC (Alle 20)
            const now = Date.now();
            
            // Fire / Multi (ðŸ¹âœ¨)
            const fireRate = 850 / (player.skills.fire || 1);
            if(now - player.lastFire > fireRate) {
                let target = null, minDist = 850;
                world.enemies.forEach(en => {
                    const d = Math.hypot(en.x-player.x, en.y-player.y);
                    if(d < minDist) { minDist = d; target = en; }
                });

                if(target) {
                    const a = Math.atan2(target.y-player.y, target.x-player.x);
                    const count = player.skills.mult ? 1 + Math.floor(player.skills.mult/1.3) : 1;
                    for(let i=0; i<count; i++) {
                        const spread = (i - (count-1)/2) * 0.28;
                        world.projectiles.push({
                            x: player.x, y: player.y, 
                            vx: Math.cos(a+spread)*17, vy: Math.sin(a+spread)*17, 
                            l: 100, dmg: 15 + (player.skills.aoe?8:0)
                        });
                    }
                    player.lastFire = now;
                }
            }

            // Blitz (âš¡)
            if(player.skills.bolt && Math.random() < 0.03 * player.skills.bolt) {
                let t = world.enemies[Math.floor(Math.random()*world.enemies.length)];
                if(t && Math.hypot(t.x-player.x, t.y-player.y) < 700) {
                    t.curHp -= 40 * player.skills.bolt;
                    world.effects.push({t:'bolt', x1:player.x, y1:player.y, x2:t.x, y2:t.y, l:12});
                }
            }
            
            // Gift (ðŸ§ª)
            if(player.skills.poi && player.frame % 40 === 0) {
                world.poisons.push({x:player.x, y:player.y, r: 80+(player.skills.poi*20), l:200});
            }

            // 4. ENTITY PROCESSING
            updateEntities();
            drawFrame();
            requestAnimationFrame(engineLoop);
        }

        function updateEntities() {
            // Projectiles
            world.projectiles.forEach((p, i) => {
                p.x += p.vx; p.y += p.vy; p.l--;
                world.enemies.forEach(en => {
                    if(Math.hypot(p.x-en.x, p.y-en.y) < en.sz+15) {
                        const crit = player.skills.crit && Math.random() < 0.22;
                        en.curHp -= p.dmg * (crit?2.8:1);
                        p.l = 0;
                        if(player.skills.aoe) world.effects.push({t:'boom', x:en.x, y:en.y, r:60, l:10});
                    }
                });
                if(p.l <= 0) world.projectiles.splice(i, 1);
            });

            // Enemies
            world.enemies.forEach((en, i) => {
                const a = Math.atan2(player.y-en.y, player.x-en.x);
                const slow = (player.skills.ice && Math.hypot(en.x-player.x, en.y-player.y) < 400) ? 0.6 : 1;
                en.x += Math.cos(a)*en.spd*slow;
                en.y += Math.sin(a)*en.spd*slow;
                
                if(en.segments) {
                    en.segments.unshift({x:en.x, y:en.y});
                    en.segments.pop();
                }

                // Skill: Wall (ðŸ§±) Block
                world.walls.forEach(w => {
                    if(Math.hypot(en.x-w.x, en.y-w.y) < w.r) {
                        en.x -= Math.cos(a)*en.spd*2; en.y -= Math.sin(a)*en.spd*2;
                    }
                });

                // Damage
                if(Math.hypot(player.x-en.x, player.y-en.y) < player.size+en.sz) {
                    player.hp -= (0.7 / (player.skills.arm || 1));
                    if(player.hp <= 0) location.reload();
                }

                if(en.curHp <= 0) {
                    if(player.skills.vamp && Math.random() < 0.1) player.hp = Math.min(player.maxHp, player.hp+2);
                    if(player.skills.shrd) { // Shard Explode
                        for(let k=0; k<4; k++) world.projectiles.push({x:en.x, y:en.y, vx:Math.random()*10-5, vy:Math.random()*10-5, l:20, dmg:5});
                    }
                    world.gems.push({x:en.x, y:en.y, v:35 * (player.skills.gold?1.8:1)});
                    world.enemies.splice(i, 1); player.score++; updateHUD();
                }
            });

            // Gems
            world.gems.forEach((g, i) => {
                const d = Math.hypot(player.x-g.x, player.y-g.y);
                const magnet = 180 + (player.skills.mag || 0)*90;
                if(d < magnet) {
                    g.x += (player.x-g.x)*0.25; g.y += (player.y-g.y)*0.25;
                    if(d < 25) {
                        world.gems.splice(i,1); player.xp += g.v;
                        if(player.xp >= player.nextXp) {
                            player.lvl++; player.xp=0; player.nextXp *= 1.45; triggerLevelUp();
                        }
                        updateHUD();
                    }
                }
            });
            
            // Timed Effects
            world.poisons.forEach((p,i) => { p.l--; if(p.l<0) world.poisons.splice(i,1); });
        }

        function drawFrame() {
            ctx.clearRect(0, 0, cw, ch);
            ctx.save();
            ctx.translate(-cam.x, -cam.y);

            // World Map
            ctx.strokeStyle = 'rgba(255,255,255,0.06)'; ctx.lineWidth =
